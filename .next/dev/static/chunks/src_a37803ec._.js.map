{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/antigravity/SajangnimBiseo/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\r\n"],"names":[],"mappings":";;;;AAEoB;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,iMAAY,EAAC,aAAa"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/antigravity/SajangnimBiseo/src/app/announcements/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Megaphone, Calendar, Building2, ChevronRight, Search, Settings2, RefreshCw, ExternalLink } from \"lucide-react\";\r\n\r\ntype Announcement = {\r\n    id: string;\r\n    title: string;\r\n    category: string | null;\r\n    announce_date: string | null;\r\n    description: string | null;\r\n    source_url: string | null;\r\n    scraped_at: string;\r\n    org_id: number | null;\r\n    org_name: string | null;   // rfp_public_org.org_name (join)\r\n};\r\n\r\nconst CATEGORIES = [\"전체\", \"입찰공고\", \"공고\"];\r\n\r\nconst CATEGORY_COLORS: Record<string, { bg: string; text: string; border: string }> = {\r\n    \"입찰공고\": { bg: \"bg-blue-50\", text: \"text-blue-700\", border: \"border-blue-200\" },\r\n    \"공고\": { bg: \"bg-purple-50\", text: \"text-purple-700\", border: \"border-purple-200\" },\r\n    \"기타\": { bg: \"bg-slate-50\", text: \"text-slate-700\", border: \"border-slate-200\" },\r\n};\r\n\r\nfunction getDateLabel(announce_date: string | null): { label: string; urgent: boolean } {\r\n    if (!announce_date) return { label: \"날짜 미정\", urgent: false };\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    const d = new Date(announce_date);\r\n    d.setHours(0, 0, 0, 0);\r\n    const diff = Math.ceil((d.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\r\n    if (diff < 0) return { label: \"마감\", urgent: false };\r\n    if (diff === 0) return { label: \"D-Day\", urgent: true };\r\n    if (diff <= 7) return { label: `D-${diff}`, urgent: true };\r\n    return { label: `D-${diff}`, urgent: false };\r\n}\r\n\r\nexport default function AnnouncementsPage() {\r\n    const [announcements, setAnnouncements] = useState<Announcement[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedCategory, setSelectedCategory] = useState(\"전체\");\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [lastUpdated, setLastUpdated] = useState<string>(\"\");\r\n\r\n    useEffect(() => {\r\n        fetchAnnouncements();\r\n    }, []);\r\n\r\n    async function fetchAnnouncements() {\r\n        setLoading(true);\r\n        const { data, error } = await supabase\r\n            .from(\"rfp_announcements\")\r\n            .select(`\r\n                id,\r\n                title,\r\n                category,\r\n                announce_date,\r\n                description,\r\n                source_url,\r\n                scraped_at,\r\n                org_id,\r\n                rfp_public_org ( org_name )\r\n            `)\r\n            .eq(\"is_active\", true)\r\n            .order(\"announce_date\", { ascending: false })\r\n            .limit(200);\r\n\r\n        if (!error && data) {\r\n            // rfp_public_org 조인 결과를 flat하게 변환\r\n            const flat: Announcement[] = data.map((row: any) => ({\r\n                id: row.id,\r\n                title: row.title,\r\n                category: row.category,\r\n                announce_date: row.announce_date,\r\n                description: row.description,\r\n                source_url: row.source_url,\r\n                scraped_at: row.scraped_at,\r\n                org_id: row.org_id,\r\n                org_name: row.rfp_public_org?.org_name ?? null,\r\n            }));\r\n            setAnnouncements(flat);\r\n            setLastUpdated(new Date().toLocaleTimeString(\"ko-KR\"));\r\n        }\r\n        setLoading(false);\r\n    }\r\n\r\n    const filtered = announcements.filter((a) => {\r\n        const matchCategory = selectedCategory === \"전체\" || a.category === selectedCategory;\r\n        const q = searchQuery.toLowerCase();\r\n        const matchSearch =\r\n            q === \"\" ||\r\n            a.title.toLowerCase().includes(q) ||\r\n            (a.org_name ?? \"\").toLowerCase().includes(q) ||\r\n            (a.description ?? \"\").toLowerCase().includes(q);\r\n        return matchCategory && matchSearch;\r\n    });\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* 헤더 */}\r\n            <div className=\"flex justify-between items-start flex-wrap gap-3\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold tracking-tight text-slate-900 flex items-center gap-2\">\r\n                        <Megaphone className=\"h-6 w-6 text-blue-500\" />\r\n                        사업공고\r\n                    </h2>\r\n                    <p className=\"text-slate-500 text-sm mt-1\">\r\n                        공공기관 입찰·지원 공고를 자동 수집하여 제공합니다.\r\n                        {lastUpdated && (\r\n                            <span className=\"ml-2 text-slate-400 text-xs\">· {lastUpdated} 기준</span>\r\n                        )}\r\n                    </p>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <button\r\n                        onClick={fetchAnnouncements}\r\n                        className=\"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-all\"\r\n                        title=\"새로고침\"\r\n                    >\r\n                        <RefreshCw className={`h-4 w-4 ${loading ? \"animate-spin\" : \"\"}`} />\r\n                        새로고침\r\n                    </button>\r\n                    <Link\r\n                        href=\"/announcements/admin\"\r\n                        className=\"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-all\"\r\n                    >\r\n                        <Settings2 className=\"h-4 w-4\" />\r\n                        기관 관리\r\n                    </Link>\r\n                    <div className=\"text-sm text-slate-500 bg-slate-50 px-3 py-1.5 rounded-full border border-slate-200 font-medium\">\r\n                        총 {filtered.length}건\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 검색 + 카테고리 필터 */}\r\n            <div className=\"flex flex-col sm:flex-row gap-3\">\r\n                <div className=\"relative flex-1\">\r\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400\" />\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"공고명, 기관명, 내용으로 검색...\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                        className=\"w-full pl-10 pr-4 py-2.5 text-sm border border-slate-200 rounded-lg bg-white text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition\"\r\n                    />\r\n                </div>\r\n                <div className=\"flex gap-2 flex-wrap\">\r\n                    {CATEGORIES.map((cat) => (\r\n                        <button\r\n                            key={cat}\r\n                            onClick={() => setSelectedCategory(cat)}\r\n                            className={`px-4 py-2 rounded-lg text-sm font-medium transition-all border ${selectedCategory === cat\r\n                                ? \"bg-blue-600 text-white border-blue-600 shadow-sm\"\r\n                                : \"bg-white text-slate-600 border-slate-200 hover:bg-slate-50 hover:border-slate-300\"\r\n                                }`}\r\n                        >\r\n                            {cat}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* 공고 목록 */}\r\n            {loading ? (\r\n                <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                    {[...Array(6)].map((_, i) => (\r\n                        <div key={i} className=\"h-52 bg-slate-100 rounded-xl animate-pulse\" />\r\n                    ))}\r\n                </div>\r\n            ) : filtered.length === 0 ? (\r\n                <div className=\"text-center py-24 text-slate-400\">\r\n                    <Megaphone className=\"h-12 w-12 mx-auto mb-3 opacity-30\" />\r\n                    <p className=\"font-medium\">해당하는 공고가 없습니다.</p>\r\n                    <p className=\"text-sm mt-1 text-slate-300\">기관을 등록하고 수집을 실행해보세요.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                    {filtered.map((item) => {\r\n                        const dday = getDateLabel(item.announce_date);\r\n                        const catColor = CATEGORY_COLORS[item.category ?? \"기타\"] ?? CATEGORY_COLORS[\"기타\"];\r\n                        return (\r\n                            <div key={item.id} className=\"group flex flex-col rounded-xl border border-slate-200 bg-white hover:shadow-md hover:border-blue-200 transition-all duration-200 overflow-hidden\">\r\n                                {/* 카드 헤더 */}\r\n                                <div className=\"px-4 pt-4 pb-3 space-y-2 flex-1\">\r\n                                    {/* 배지 행 */}\r\n                                    <div className=\"flex items-center justify-between gap-2\">\r\n                                        <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border ${catColor.bg} ${catColor.text} ${catColor.border}`}>\r\n                                            {item.category ?? \"기타\"}\r\n                                        </span>\r\n                                        <span className={`text-xs font-bold px-2 py-0.5 rounded-full ${dday.label === \"마감\"\r\n                                            ? \"bg-slate-100 text-slate-400\"\r\n                                            : dday.urgent\r\n                                                ? \"bg-red-50 text-red-600 border border-red-200\"\r\n                                                : \"bg-slate-50 text-slate-600 border border-slate-200\"\r\n                                            }`}>\r\n                                            {dday.label}\r\n                                        </span>\r\n                                    </div>\r\n\r\n                                    {/* 제목 */}\r\n                                    <p className=\"text-sm font-semibold text-slate-900 leading-snug group-hover:text-blue-600 transition-colors line-clamp-2\">\r\n                                        {item.title}\r\n                                    </p>\r\n\r\n                                    {/* 설명 */}\r\n                                    {item.description && (\r\n                                        <p className=\"text-xs text-slate-500 line-clamp-2 leading-relaxed\">\r\n                                            {item.description}\r\n                                        </p>\r\n                                    )}\r\n                                </div>\r\n\r\n                                {/* 카드 푸터 */}\r\n                                <div className=\"px-4 py-3 border-t border-slate-100 flex items-center justify-between gap-2\">\r\n                                    <div className=\"flex flex-col gap-0.5\">\r\n                                        {item.org_name && (\r\n                                            <span className=\"flex items-center gap-1 text-xs text-slate-500\">\r\n                                                <Building2 className=\"h-3 w-3\" />\r\n                                                {item.org_name}\r\n                                            </span>\r\n                                        )}\r\n                                        {item.announce_date && (\r\n                                            <span className=\"flex items-center gap-1 text-xs text-slate-400\">\r\n                                                <Calendar className=\"h-3 w-3\" />\r\n                                                {item.announce_date}\r\n                                            </span>\r\n                                        )}\r\n                                    </div>\r\n                                    {item.source_url ? (\r\n                                        <a\r\n                                            href={item.source_url}\r\n                                            target=\"_blank\"\r\n                                            rel=\"noopener noreferrer\"\r\n                                            onClick={(e) => e.stopPropagation()}\r\n                                            className=\"flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-all\"\r\n                                        >\r\n                                            <ExternalLink className=\"h-3 w-3\" />\r\n                                            원문 보기\r\n                                        </a>\r\n                                    ) : (\r\n                                        <ChevronRight className=\"h-4 w-4 text-slate-300 group-hover:text-blue-500 transition-colors\" />\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}